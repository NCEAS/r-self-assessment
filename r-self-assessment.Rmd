---
title: R Review & Assessment
output: learnr::tutorial
runtime: shiny_prerendered
time_slot: 60 minutes"
---


```{r, include = FALSE}
library(learnr)
knitr::opts_chunk$set(collapse = TRUE)
```

## Introduction

Let's take about an hour to take a quick assessment, touch up on basic R programming skills in a survey style, and then we'll move onto some challenges which should test your understanding if we have time.

## Learning Outcomes

- Assess where everyone is with R so we can shape the curricula
- Refresh general R programming skills
- Test R skills against some example problems

## R overview

Based on previous R training: https://github.nceas.ucsb.edu/Training/R-intro.
Instructor will go over these live with the classroom, running 

- Basic syntax
  - Variables & assignemnt
  
### The assignment operator, `<-`

One of the things we'll do all the time is save some value to a variable.
Here, we save the word "apple" to a variable called `fruit`

```{r}
fruit <- "apple"
fruit
```

Notice the last line with just `fruit` on it.
Typing just the variable name in just prints the value to the Console.

R has a flexible syntax.
The following two lines of code are identical to the above one.

```{r}
fruit<-"apple"
fruit    <-     "apple"
```

### R as a calculator: `+ - * / > >= %% %/%` etc
  
```{r, collapse = TRUE}
2+2
2 * 3
2 ^ 3
5/2
```

Comparison:

```{r, collapse = TRUE}
2 == 1
2 == 2
3 > 2
2 < 3 # Same as above
"apple" == "apple"
"apple" == "pair"
"pair" == "apple" # Order doesn't matter for ==
```


### Types of variables

#### Vectors

When we run a line of code like this:

```{r}
x <- 2
```

We're assigning 2 to a variable `x`.
`x` is a variable but it is also a "numeric vector" of length 1.

```{r, collapse = T}
class(x)
length(x)
```

Above, we ran two function: `class` and `length` on our variable `x`.
Running functions is a very common thing you'll do in R.
Every function has a name, following by a pair of `()` with something inside.

We can make a numeric vector that is longer like so:

```{r}
x <- c(1, 2, 3) # Use the `c` function to put things together
```

Notice we can also re-define a variable at a later point just like we did above.

```{r, collapse = TRUE}
class(x)
length(x)
```

R can store much more than just numbers though.
Let's start with strings of characters, which we've already seen:

```{r, collapse = TRUE}
fruit <- "apple"
class(fruit)
length(fruit)
```

Depending on your background, you may be surprised that the result of running `length(fruit)` is 1 because "apple" is five characters long.

It turns out that `fruit` is a character vector of length one, just like our numeric vector from before.
To find out the number of characters in "apple", we have to use another function:

```{r}
nchar(fruit)
nchar("apple")
```

Let's make a character vector of more than length one and take a look at how it works:

```{r}
fruits <- c("apple", "banana", "strawberry")
length(fruits)
nchar(fruits)
fruits[1]
```

Smushing character vectors together can be done with `paste`:

```{r}
paste("key", "lime", "pie")
```

#### Lists

Vectors and lists look similar in R sometimes but they have very different uses:

```{r}
c(1, "apple", 3)
list(1, "apple", 3)
```

#### data.frames
Most of the time when doing analysis in R you will be working with `data.frames`.
`data.frames` are tabular, with column headings and rows of data, just like a CSV file.

We create new `data.frames` with a relevantly-named function:

```{r}
mydata <- data.frame(site = c("A", "B", "C"),
                     temp = c(20, 30, 40))
mydata
```

Or we can read in a CSV from the file system and turn it into a `data.frame` in order to work with it in R:

```{r}
mydata <- read.csv("data.csv")
mydata
```

We can find out how many rows of data `mydata` has in it:

```{r}
nrow(mydata)
```

We can return just one of the columns:

```{r}
mydata$type
unique(mydata$type)
```
sort

If we want to sort `mydata`, we use the `order` function (in kind of a weird way):

```{r}
mydata[order(mydata$type),]
```

Let's break the above command down a bit.
We can access the individual cells of a `data.frame` with a new syntax element: `[` and `[`:

```{r}
mydata[1,] # First row
mydata[,1] # First column
mydata[1,1] # First row, first column
mydata[c(1,5),] # First and second row
mydata$type # Column named 'type'
```

So what does that `order` function do?

```{r, eval = FALSE}
?order # How to get help in R!
```

```{r}
order(c(1, 2, 3))
order(c(3, 2, 1))
order(mydata$type)
```

So `order(mydata$type)` is returning the rows of `mydata`, by row number, in sorted order.

We can also return just certain rows, based upon criteria:

```{r}
mydata[mydata$type == "fruit",]
mydata$type == "fruit"
```

In this case, instead of indexing the rows by number, we're using TRUEs and FALSEs.

**Exercise:** Subset `mydata` to the vegetables instead of the fruit

```{r}
# Your code here
```

Another handy way to subset `data.frame` is with the `subset` function:
    
```{r}
subset(mydata, type == "fruit") # Equivalent to mydata[mydata$type == "fruit",]
```

There are a lot of useful functions to help us work with `data.frame`s:

```{r}
str(mydata)
summary(mydata)
```

### More advanced topics to cover if time allows:

- Common util functions
    - `table`
- Iteration
    - `for` loops
        - When do we use for loops?
    - `while` loops
- Debugging
  - traceback()
  - browser()
  - breakpoints in RStudio
  


## Assessment

Everyone will arrive to this lesson with different experiences with R.
Skill with R doesn't necessarily exist a continuum and can instead be thought of as a set of tools.
Each particpant may start the workshop with different tools.

In order to get a better sense of what topics in R we should focus more heavily on, let's do a quick assessment.
The results will help us shape instruction so that we can ensure we're meeting everyone's needs.

**Instructions:** 

Answer the following 5 questions to the best of your knowledge and write down your answers.

### Question 1

Which line of code can be used to read in the `data.csv` file?

```{r q1, echo = FALSE}
question("",
         answer("read.csv('data.csv')", correct = T),
         answer("read('data.csv')"),
         answer("tidyr::read_csv('data.csv')", correct = T),
         answer("data('data.csv')"),
         type = "learnr_radio"
         )

```


### Question 2

What does the following expression return?

`max(abs(c(-5, 1, 5)))`
```{r q2, echo = FALSE}
question("",
         answer("-5"),
         answer("1"),
         answer("5", correct = T),
         answer("An error")
         )

```


### Question 3

If x and y are both data.frames defined by:

```{r}
x <- data.frame(z = 1:2)
y <- data.frame(z = 3)
```

which of the following expressions would be a correct way to combine them into one data.frame that looks like this:

```
z
-
1
2
3
```

(i.e. one column with the numbers 1, 2, and 3 in it)

```{r q3, echo = FALSE}
question("",
         answer("join(x,y)"),
         answer("c(x,y)"),
         answer("rbind(x,y)", correct = T),
         answer("x+y")
         )

```


### Question 4
  
What is the output of the following code chunk?

```{r, eval = FALSE}
x <- data.frame(x = 1:10, y = 1:10)
dim(x)
```

```{r q4, echo = FALSE}
question("",
         answer("2"),
         answer("10"),
         answer("10 2", correct = T),
         answer("10 10")
         )

```


### Question 5

What is the output of the following code chunk?

```{r, eval = FALSE}
x <- data.frame(x = 1:3)
y <- data.frame(x = 1:7)
z <- cbind(x, y)
nrow(z)
```

```{r q5, echo = FALSE}
question("",
         answer("3"),
         answer("7"),
         answer("10"),
         answer("Error: different number of rows", correct = T)
         )

```


  
Use the following data frame for the next two questions:

`x <- data.frame(w = -9:0, y = 1:10, z = 11:20)`

### Question 6

Which expression(s) return a `data.frame` with rows where y is greater than 5 (i.e. 6 - 10)

There are 2 correct answers, but only 1 is required:

```{r q6, echo = FALSE}
question("",
         answer("x$y > 5"),
         answer("subset(x, y > 5)", correct = T),
         answer("x[y > 5,]"),
         answer("dplyr::filter(x, y > 5)", correct = T),
         type = "learnr_radio"
         )

```


### Question 7

Which expresssion(s) return a `data.frame` where ony the columns `w` and `z` are retained?
There are 2 correct answers, but only 1 is required:

```{r q7, echo = FALSE}
question("",
         answer("x[,c(w,z)]"),
         answer("subset(x, c('w','z'))"),
         answer("subset(x, select = c('w', 'z')", correct = T),
         answer("dplyr::select(x, w,z)", correct = T),
         type = "learnr_radio"
         )

```



### Question 8
Use the following data.frame `iris` to answer the next question.

```{r, echo = FALSE}
head(iris)
```


Which expression return a `data.frame` with rows where Species is "setosa" and only the columns `Sepal.Length` and `Species`?

There are 2 correct answers, but only 1 is required:

```{r q8, echo = FALSE}
question("",
         answer('dplyr::select(dplyr::filter(iris, Species == "setosa"), Sepal.Length, Species)', correct = T),
         answer('iris["setosa", c("Sepal.Length", "Species")]'),
         answer('iris[Species == "setosa" & c("Sepal.Length", "Species"),]'),
         answer('subset(iris, Species == "setosa", c("Sepal.Length", "Species"))', correct = T),
         type = "learnr_radio"
         )


```


For the questions below, unless otherwise specified, select the output of the following code chunks.

### Question 9

```{r, eval = FALSE}
x <- 2
x ^ 2
```

```{r q9, echo = FALSE}
question("",
         answer("2"),
         answer("4", correct= T),
         answer("2 ^ 2"),
         answer("x ^ 2")
         )

```


### Question 10

```{r, eval = FALSE}
x <- "hello"
y <- "world"
paste(x, y)
```

```{r q10, echo = FALSE}
question("",
         answer('"hello world"', correct = T),
         answer('"hello" "world"'),
         answer('"hello, world"'),
         answer('"helloworld"')
         )

```


### Question 11

```{r, eval = FALSE}
x <- NA

if (is.na(x)) {
  print("foo")
} else {
  print("bar")
}
```

```{r q11, echo = FALSE}
question("",
         answer('"foo"', correct = T),
         answer('"bar"'),
         answer('NA'),
         answer('"foobar"')
         )

```


### Question 12

What will the following code print?

```{r, eval = FALSE}
numbers <- seq(1, 3)
count <- 0
for (number in numbers) {
  count <- count + number
}
print(count)
```

```{r q12, echo = FALSE}
question("",
         answer("0"),
         answer("3"),
         answer("9"),
         answer("6", correct= T)
         )

```



### Question 13

```{r, eval = FALSE}
x <- c(1, "2", 3)
class(x)
```

```{r q13, echo = FALSE}
question("",
         answer("numeric"),
         answer("character", correct = T),
         answer("factor"),
         answer('"numeric" "character" "numeric"')
         )

```


### Question 14

```{r, eval = FALSE}
x <- c(1, "A", 3)
as.numeric(x)
```

```{r q14, echo = FALSE}
question("",
         answer("NA NA NA"),
         answer("1 A 3"),
         answer("1 NA 3", correct = T),
         answer("TRUE FALSE TRUE")
         )

```


---- move this to learning section
### Question 20

```{r, eval = FALSE}
rep(TRUE, 5) & rep(FALSE, 5)
```

- A. FALSE
- B. TRUE
- C. FALSE FALSE FALSE FALSE FALSE
- D. TRUE TRUE TRUE TRUE TRUE
- E. TRUE TRUE TRUE TRUE TRUE FALSE FALSE FALSE FALSE FALSE

### Question 21

```{r, eval = FALSE}
rep(TRUE, 5) && rep(FALSE, 5)
```

- A. FALSE
- B. TRUE
- C. FALSE FALSE FALSE FALSE FALSE
- D. TRUE TRUE TRUE TRUE TRUE
- E. TRUE TRUE TRUE TRUE TRUE FALSE FALSE FALSE FALSE FALSE

--------------


### Question 15

```{r, eval = FALSE}
x <- c(1, 2, NA, 4, NA)
sum(is.na(x))
```

```{r q15, echo = FALSE}
question("",
         answer("1"),
         answer("2", correct = T),
         answer("5"),
         answer("NA")
         )
```

### Question 16

```{r, eval = FALSE}
x <- c(1, NA, 3)
y <- c(NA, 2, NA)

z <- data.frame(x,y)

colSums(is.na(z))
```

```{r q16, echo = FALSE}
question("",
         answer("NA NA"),
         answer("1 2", correct = T),
         answer("1 1 1"),
         answer("3")
         )

```



  
    
    
    
    

## Summary

By the end of this lesson, you should have feel touched up on your general R skills and you also should have seen some of the trickier parts of R.
Hopefully having seen the trickier parts of R will help later on down the road.

## Resources

Other good resources:

- One of our lessons on R: https://github.nceas.ucsb.edu/Training/R-intro
- Great, free book: http://r4ds.had.co.nz/
- DataCamp's R intro, https://www.datacamp.com/courses/free-introduction-to-r
Sources:
- Used https://www.rstudio.com/resources/cheatsheets/ to make sure I wasn't missing any basic stuff